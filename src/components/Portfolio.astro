---
import Icon from './Icon.astro';

const projects = [
  {
    id: 1,
    title: 'EcoTech Solutions - Web App',
    category: 'web-app',
    client: 'EcoTech Solutions',
    description:
      'Plataforma integral para gestión de procesos ambientales con dashboard en tiempo real y sistema de reportes automatizado.',
    image: '/project-1.svg',
    technologies: ['React', 'TypeScript', 'Node.js', 'PostgreSQL', 'Docker'],
    features: [
      'Dashboard interactivo con métricas en tiempo real',
      'Sistema de reportes automatizado',
      'API REST robusta y escalable',
      'Integración con sensores IoT',
      'Notificaciones push y email',
    ],
    results: {
      metric1: { value: '60%', label: 'Reducción tiempo de procesamiento' },
      metric2: { value: '99.9%', label: 'Uptime del sistema' },
      metric3: { value: '150%', label: 'Aumento productividad' },
    },
    testimonial: 'La plataforma revolucionó nuestra operación completamente.',
    link: '#',
    status: 'Completado',
  },
  {
    id: 2,
    title: 'Boutique Luna - E-commerce',
    category: 'ecommerce',
    client: 'Boutique Luna',
    description:
      'Tienda online completa con gestión de inventario, múltiples métodos de pago y integración con redes sociales.',
    image: '/project-2.svg',
    technologies: ['Next.js', 'Tailwind CSS', 'Stripe', 'Prisma', 'Vercel'],
    features: [
      'Carrito de compras intuitivo',
      'Múltiples métodos de pago',
      'Gestión de inventario en tiempo real',
      'Integración con Instagram',
      'Panel de administración completo',
    ],
    results: {
      metric1: { value: '300%', label: 'Aumento ventas online' },
      metric2: { value: '85%', label: 'Tasa de conversión' },
      metric3: { value: '4.9/5', label: 'Satisfacción del cliente' },
    },
    testimonial: 'Las ventas online se triplicaron en solo tres meses.',
    link: '#',
    status: 'Completado',
  },
  {
    id: 3,
    title: 'Transportes La Pampa - Mobile App',
    category: 'mobile',
    client: 'Transportes La Pampa',
    description:
      'Aplicación móvil para conductores y clientes con tracking en tiempo real y gestión de rutas optimizada.',
    image: '/project-3.svg',
    technologies: [
      'React Native',
      'Firebase',
      'Google Maps API',
      'Push Notifications',
    ],
    features: [
      'Tracking GPS en tiempo real',
      'Optimización automática de rutas',
      'Chat en vivo conductor-cliente',
      'Sistema de calificaciones',
      'Reportes de rendimiento',
    ],
    results: {
      metric1: { value: '40%', label: 'Reducción tiempos de entrega' },
      metric2: { value: '95%', label: 'Satisfacción del usuario' },
      metric3: { value: '25%', label: 'Ahorro en combustible' },
    },
    testimonial: 'La app transformó completamente nuestra logística.',
    link: '#',
    status: 'Completado',
  },
  {
    id: 4,
    title: 'FinTech Pampa - Backend Seguro',
    category: 'backend',
    client: 'FinTech Pampa',
    description:
      'Backend ultra-seguro para aplicación fintech con encriptación de extremo a extremo y compliance bancario.',
    image: '/project-4.svg',
    technologies: ['Python', 'FastAPI', 'PostgreSQL', 'Redis', 'AWS'],
    features: [
      'Encriptación extremo a extremo',
      'Autenticación multifactor',
      'Auditoría completa de transacciones',
      'APIs con rate limiting',
      'Compliance PCI DSS',
    ],
    results: {
      metric1: { value: '0', label: 'Incidentes de seguridad' },
      metric2: { value: '<100ms', label: 'Tiempo respuesta API' },
      metric3: { value: '99.99%', label: 'Disponibilidad' },
    },
    testimonial: 'Nivel de seguridad y performance excepcional.',
    link: '#',
    status: 'Completado',
  },
  {
    id: 5,
    title: 'González & Asociados - Web Corporativo',
    category: 'website',
    client: 'González & Asociados',
    description:
      'Sitio web corporativo moderno con sistema CMS personalizado y optimización SEO avanzada.',
    image: '/project-5.svg',
    technologies: ['Astro', 'TypeScript', 'Tailwind CSS', 'Strapi', 'Netlify'],
    features: [
      'Diseño responsive y accesible',
      'CMS personalizado fácil de usar',
      'SEO técnico optimizado',
      'Blog integrado',
      'Formularios de contacto inteligentes',
    ],
    results: {
      metric1: { value: '150%', label: 'Aumento conversiones' },
      metric2: { value: '100/100', label: 'Lighthouse Score' },
      metric3: { value: '250%', label: 'Mejora tráfico orgánico' },
    },
    testimonial: 'El sitio superó todas nuestras expectativas.',
    link: '#',
    status: 'Completado',
  },
  {
    id: 6,
    title: 'Café Central - Sistema Pedidos',
    category: 'web-app',
    client: 'Café Central',
    description:
      'Sistema de pedidos online con integración a WhatsApp, gestión de mesas y dashboard de analytics.',
    image: '/project-6.svg',
    technologies: ['Vue.js', 'Node.js', 'MySQL', 'WhatsApp API', 'PWA'],
    features: [
      'Menú digital interactivo',
      'Pedidos por WhatsApp',
      'Gestión de mesas en tiempo real',
      'Sistema de fidelización',
      'Analytics de ventas',
    ],
    results: {
      metric1: { value: '80%', label: 'Reducción tiempo de espera' },
      metric2: { value: '200%', label: 'Aumento pedidos online' },
      metric3: { value: '65%', label: 'Mejora en satisfacción' },
    },
    testimonial: 'Nos ayudó a sobrevivir la pandemia y crecer.',
    link: '#',
    status: 'Completado',
  },
];

const categories = [
  { id: 'all', label: 'Todos', icon: 'Grid' },
  { id: 'website', label: 'Sitios Web', icon: 'Globe' },
  { id: 'ecommerce', label: 'E-commerce', icon: 'ShoppingCart' },
  { id: 'web-app', label: 'Web Apps', icon: 'Monitor' },
  { id: 'mobile', label: 'Apps Móviles', icon: 'Smartphone' },
  { id: 'backend', label: 'Backend/APIs', icon: 'Server' },
];
---

<section id="proyectos" class="py-24 lg:py-32 bg-white">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    
    <!-- Section Header -->
    <div class="text-center max-w-3xl mx-auto mb-16">
      <h2 class="text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold text-gray-900 leading-[1.15] md:leading-[1.1] tracking-tight mb-8">
        Nuestro
        <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
          portafolio
        </span>
        de éxito
      </h2>
      <p class="text-xl md:text-2xl text-gray-600 leading-[1.7] mb-12">
        Descubre algunos de los proyectos que hemos desarrollado para empresas como la tuya. 
        Cada proyecto es único y está diseñado para superar expectativas.
      </p>
    </div>

    <!-- Filter Buttons -->
    <div class="flex flex-wrap justify-center gap-4 mb-12">
      {categories.map((category) => (
        <button 
          class="portfolio-filter px-6 py-3 rounded-full border-2 border-gray-200 text-gray-600 hover:border-blue-500 hover:text-blue-600 hover:bg-blue-50 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
          data-filter={category.id}
        >
          <span class="flex items-center">
            <Icon name={category.icon} class="h-4 w-4 mr-2" />
            {category.label}
          </span>
        </button>
      ))}
    </div>

    <!-- Projects Grid -->
    <div id="projects-grid" class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16">
      
      {projects.map((project, index) => (
        <article 
          class="project-card bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-all duration-300 hover:-translate-y-2"
          data-category={project.category}
          data-aos="fade-up"
          data-aos-delay={index * 100}
        >
          
          <!-- Project Image -->
          <div class="relative overflow-hidden group">
            <div class="aspect-video">
              <img src={project.image} alt={project.title} class="w-full h-full object-cover" />
            </div>
            
            <!-- Image Overlay -->
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
              <div class="absolute bottom-4 left-4 right-4">
                <div class="flex flex-wrap gap-2">
                  {project.technologies.slice(0, 3).map((tech) => (
                    <span class="bg-white/20 backdrop-blur-sm text-white text-xs px-2 py-1 rounded-full">
                      {tech}
                    </span>
                  ))}
                  {project.technologies.length > 3 && (
                    <span class="bg-white/20 backdrop-blur-sm text-white text-xs px-2 py-1 rounded-full">
                      +{project.technologies.length - 3}
                    </span>
                  )}
                </div>
              </div>
            </div>

            <!-- Status Badge -->
            <div class="absolute top-4 left-4">
              <span class="bg-green-500 text-white text-xs px-3 py-1 rounded-full font-medium">
                {project.status}
              </span>
            </div>
          </div>

          <!-- Project Content -->
          <div class="p-8">
            
            <!-- Project Header -->
            <div class="mb-6">
              <div class="flex items-center justify-between mb-2">
                <h3 class="text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors duration-200">
                  {project.title}
                </h3>
                <button class="expand-project p-2 rounded-full hover:bg-gray-100 transition-colors duration-200" data-project={project.id}>
                  <Icon name="Eye" class="h-5 w-5 text-gray-600" />
                </button>
              </div>
              <p class="text-sm text-blue-600 font-medium mb-3">{project.client}</p>
              <p class="text-gray-600 leading-relaxed">{project.description}</p>
            </div>

            <!-- Key Results -->
            <div class="grid grid-cols-3 gap-4 mb-6">
              <div class="text-center">
                <div class="text-lg font-bold text-gray-900">{project.results.metric1.value}</div>
                <div class="text-xs text-gray-600 leading-tight">{project.results.metric1.label}</div>
              </div>
              <div class="text-center">
                <div class="text-lg font-bold text-gray-900">{project.results.metric2.value}</div>
                <div class="text-xs text-gray-600 leading-tight">{project.results.metric2.label}</div>
              </div>
              <div class="text-center">
                <div class="text-lg font-bold text-gray-900">{project.results.metric3.value}</div>
                <div class="text-xs text-gray-600 leading-tight">{project.results.metric3.label}</div>
              </div>
            </div>

            <!-- Client Testimonial -->
            <blockquote class="border-l-4 border-blue-500 pl-4 mb-6">
              <p class="text-sm text-gray-600 italic">"{project.testimonial}"</p>
              <cite class="text-xs text-gray-500">- {project.client}</cite>
            </blockquote>

            <!-- Action Button -->
            <button class="view-details w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold py-3 px-6 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-200 hover:shadow-lg transform hover:-translate-y-0.5" data-project={project.id}>
              Ver Detalles del Proyecto
              <Icon name="ArrowRight" class="inline-block ml-2 h-4 w-4" />
            </button>
          </div>

        </article>
      ))}

    </div>

    <!-- Load More Button -->
    <div class="text-center">
      <button class="inline-flex items-center px-8 py-4 border-2 border-gray-300 text-gray-700 font-semibold rounded-xl hover:border-blue-500 hover:text-blue-600 hover:bg-blue-50 transition-all duration-300 transform hover:-translate-y-1">
        Ver Más Proyectos
        <Icon name="Plus" class="ml-2 h-5 w-5" />
      </button>
    </div>

  </div>
</section>

<!-- Project Detail Modal -->
<div id="project-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden opacity-0 transition-opacity duration-300">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300" id="modal-content">
      
      <!-- Modal Header -->
      <div class="sticky top-0 bg-white border-b border-gray-200 px-8 py-6 flex items-center justify-between">
        <h3 id="modal-title" class="text-2xl font-bold text-gray-900"></h3>
        <button id="close-modal" class="p-2 rounded-full hover:bg-gray-100 transition-colors duration-200">
          <Icon name="X" class="h-6 w-6 text-gray-600" />
        </button>
      </div>

      <!-- Modal Content -->
      <div class="px-8 py-6">
        
        <!-- Project Info -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
          
          <!-- Left Column -->
          <div>
            <div class="mb-6">
              <h4 class="text-lg font-semibold text-gray-900 mb-3">Descripción del Proyecto</h4>
              <p id="modal-description" class="text-gray-600 leading-relaxed"></p>
            </div>

            <div class="mb-6">
              <h4 class="text-lg font-semibold text-gray-900 mb-3">Cliente</h4>
              <p id="modal-client" class="text-blue-600 font-medium"></p>
            </div>
          </div>

          <!-- Right Column -->
          <div>
            <div class="mb-6">
              <h4 class="text-lg font-semibold text-gray-900 mb-3">Tecnologías Utilizadas</h4>
              <div id="modal-technologies" class="flex flex-wrap gap-2"></div>
            </div>

            <div class="mb-6">
              <h4 class="text-lg font-semibold text-gray-900 mb-3">Estado</h4>
              <span id="modal-status" class="bg-green-100 text-green-800 text-sm px-3 py-1 rounded-full font-medium"></span>
            </div>
          </div>

        </div>

        <!-- Features -->
        <div class="mb-8">
          <h4 class="text-lg font-semibold text-gray-900 mb-4">Características Principales</h4>
          <ul id="modal-features" class="grid grid-cols-1 md:grid-cols-2 gap-3"></ul>
        </div>

        <!-- Results -->
        <div class="mb-8">
          <h4 class="text-lg font-semibold text-gray-900 mb-4">Resultados Obtenidos</h4>
          <div id="modal-results" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
        </div>

        <!-- Testimonial -->
        <div class="bg-gray-50 rounded-xl p-6 mb-8">
          <h4 class="text-lg font-semibold text-gray-900 mb-3">Testimonio del Cliente</h4>
          <blockquote class="text-gray-600 italic">
            "<span id="modal-testimonial"></span>"
          </blockquote>
          <cite class="text-sm text-gray-500 mt-2 block">- <span id="modal-testimonial-client"></span></cite>
        </div>

      </div>

    </div>
  </div>
</div>

<script>
  // Portfolio functionality
  document.addEventListener('DOMContentLoaded', function() {
    
    // Filter functionality
    const filterButtons = document.querySelectorAll('.portfolio-filter');
    const projectCards = document.querySelectorAll('.project-card');
    
    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        const filter = button.getAttribute('data-filter');
        
        // Update active button
        filterButtons.forEach(btn => {
          btn.classList.remove('border-blue-500', 'text-blue-600', 'bg-blue-50');
          btn.classList.add('border-gray-200', 'text-gray-600');
        });
        button.classList.add('border-blue-500', 'text-blue-600', 'bg-blue-50');
        button.classList.remove('border-gray-200', 'text-gray-600');
        
        // Filter projects
        projectCards.forEach(card => {
          const category = card.getAttribute('data-category');
          if (filter === 'all' || category === filter) {
            card.style.display = 'block';
            card.style.animation = 'fadeInUp 0.5s ease-out';
          } else {
            card.style.display = 'none';
          }
        });
      });
    });

    // Set initial active state
    filterButtons[0].classList.add('border-blue-500', 'text-blue-600', 'bg-blue-50');
    filterButtons[0].classList.remove('border-gray-200', 'text-gray-600');
    
    // Modal functionality
    const modal = document.getElementById('project-modal');
    const modalContent = document.getElementById('modal-content');
    const closeModal = document.getElementById('close-modal');
    const viewDetailsButtons = document.querySelectorAll('.view-details');
    
    const projectsData = {
      1: {
        title: 'EcoTech Solutions - Web App',
        client: 'EcoTech Solutions',
        description: 'Plataforma integral para gestión de procesos ambientales con dashboard en tiempo real y sistema de reportes automatizado.',
        technologies: ['React', 'TypeScript', 'Node.js', 'PostgreSQL', 'Docker'],
        features: [
          'Dashboard interactivo con métricas en tiempo real',
          'Sistema de reportes automatizado',
          'API REST robusta y escalable',
          'Integración con sensores IoT',
          'Notificaciones push y email'
        ],
        results: {
          metric1: { value: '60%', label: 'Reducción tiempo de procesamiento' },
          metric2: { value: '99.9%', label: 'Uptime del sistema' },
          metric3: { value: '150%', label: 'Aumento productividad' }
        },
        testimonial: 'La plataforma revolucionó nuestra operación completamente.',
        status: 'Completado'
      },
      // Add other projects here...
    };

    function openModal(projectId) {
      const project = projectsData[projectId];
      if (!project) return;
      
      // Populate modal content
      document.getElementById('modal-title').textContent = project.title;
      document.getElementById('modal-description').textContent = project.description;
      document.getElementById('modal-client').textContent = project.client;
      document.getElementById('modal-status').textContent = project.status;
      document.getElementById('modal-testimonial').textContent = project.testimonial;
      document.getElementById('modal-testimonial-client').textContent = project.client;
      
      // Technologies
      const techContainer = document.getElementById('modal-technologies');
      techContainer.innerHTML = '';
      project.technologies.forEach(tech => {
        const span = document.createElement('span');
        span.className = 'bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full';
        span.textContent = tech;
        techContainer.appendChild(span);
      });
      
      // Features
      const featuresContainer = document.getElementById('modal-features');
      featuresContainer.innerHTML = '';
      project.features.forEach(feature => {
        const li = document.createElement('li');
        li.className = 'flex items-start text-gray-600';
        li.innerHTML = `
          <svg class="h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
          </svg>
          ${feature}
        `;
        featuresContainer.appendChild(li);
      });
      
      // Results
      const resultsContainer = document.getElementById('modal-results');
      resultsContainer.innerHTML = '';
      Object.values(project.results).forEach(result => {
        const div = document.createElement('div');
        div.className = 'text-center bg-white rounded-xl p-4 shadow-sm border border-gray-100';
        div.innerHTML = `
          <div class="text-2xl font-bold text-gray-900 mb-2">${result.value}</div>
          <div class="text-sm text-gray-600">${result.label}</div>
        `;
        resultsContainer.appendChild(div);
      });
      
      // Show modal
      modal.classList.remove('hidden');
      setTimeout(() => {
        modal.classList.remove('opacity-0');
        modalContent.classList.remove('scale-95');
      }, 10);
    }

    function closeModalHandler() {
      modal.classList.add('opacity-0');
      modalContent.classList.add('scale-95');
      setTimeout(() => {
        modal.classList.add('hidden');
      }, 300);
    }

    // Event listeners
    viewDetailsButtons.forEach(button => {
      button.addEventListener('click', () => {
        const projectId = button.getAttribute('data-project');
        openModal(projectId);
      });
    });

    closeModal.addEventListener('click', closeModalHandler);
    
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModalHandler();
      }
    });

    // Escape key to close modal
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
        closeModalHandler();
      }
    });
  });
</script>

<style>
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Modal animations */
  #project-modal.hidden {
    pointer-events: none;
  }

  #modal-content {
    max-height: calc(100vh - 2rem);
    overflow-y: auto;
  }

  /* Custom scrollbar for modal */
  #modal-content::-webkit-scrollbar {
    width: 6px;
  }

  #modal-content::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 3px;
  }

  #modal-content::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 3px;
  }

  #modal-content::-webkit-scrollbar-thumb:hover {
    background: #a8a8a8;
  }

  /* Responsive grid adjustments */
  @media (max-width: 768px) {
    .project-card {
      margin-bottom: 1.5rem;
    }
  }
</style>